(function(){"use strict";var t={9133:function(t,e,n){var o=n(6848),r=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("router-link",{attrs:{to:"/login"}},[t._v("login")]),e("br"),e("br"),e("router-link",{attrs:{to:"/file"}},[t._v("file")]),e("br"),e("br"),e("br"),e("br"),e("br"),e("router-view")],1)},a=[],l={name:"App",components:{}},i=l,s=n(1656),u=(0,s.A)(i,r,a,!1,null,null,null),c=u.exports,f=n(6178),d=function(){var t=this,e=t._self._c;return e("div",{staticClass:"login-container"},[e("el-form",{nativeOn:{submit:function(e){return e.preventDefault(),t.login.apply(null,arguments)}}},[e("h2",[t._v("网盘登录")]),e("el-input",{attrs:{placeholder:"用户名"},model:{value:t.form.username,callback:function(e){t.$set(t.form,"username",e)},expression:"form.username"}}),e("el-input",{attrs:{type:"password",placeholder:"密码","show-password":""},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}}),e("el-button",{attrs:{type:"primary","native-type":"submit"}},[t._v("登录")])],1)],1)},p=[],m=(n(4114),n(4373)),h=n(3518);o["default"].use(h.Ay);var v=new h.Ay.Store({state:{token:localStorage.getItem("token")||"",userRole:""},mutations:{SET_TOKEN(t,e){t.token=e,localStorage.setItem("token",e)},LOGOUT(t){t.token="",localStorage.removeItem("token")}}});const b=m.A.create({baseURL:"http://localhost:3000/api",timeout:1e4});b.interceptors.request.use((t=>(v.state.token&&(t.headers.Authorization=`Bearer ${v.state.token}`),t)));var y=b,w=n(2462),g=n.n(w);const k=t=>g()(t);var _={name:"MyLogin",data(){return{form:{username:"",password:""}}},methods:{async login(){try{const t=await y.post("/auth/login",{username:this.form.username,password:k(this.form.password)});this.$store.commit("SET_TOKEN",t.data.token),this.$router.push("/file")}catch(t){this.$message.error("登录失败")}}}},O=_,S=(0,s.A)(O,d,p,!1,null,null,null),F=S.exports,T=function(){var t=this,e=t._self._c;return e("div",{staticClass:"file-manager"},[e("el-upload",{attrs:{action:"#",multiple:"","http-request":t.handleUpload,"show-file-list":!1}},[e("el-button",{attrs:{type:"primary"}},[t._v("上传文件")])],1),e("el-table",{attrs:{data:t.files}},[e("el-table-column",{attrs:{prop:"name",label:"文件名"}}),e("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function({row:n}){return["file"===n.type?e("el-button",{on:{click:function(e){return t.downloadFile(n.path)}}},[t._v("下载")]):t._e(),e("el-button",{attrs:{type:"danger"},on:{click:function(e){return t.deleteFile(n.path)}}},[t._v("删除")])]}}])})],1)],1)},$=[],x={name:"FileManager",data(){return{files:[]}},async mounted(){await this.loadFiles()},methods:{async loadFiles(){const t=await y.get("/files");this.files=t.data},async handleUpload({file:t}){const e=new FormData;e.append("files",t);try{await y.post("/upload",e,{headers:{"Content-Type":"multipart/form-data"}}),await this.loadFiles()}catch(n){this.$message.error("上传失败")}},async deleteFile(t){try{await y.delete(`/files/${encodeURIComponent(t)}`),await this.loadFiles()}catch(e){this.$message.error("删除失败")}},downloadFile(t){window.open(`http://localhost:3000/api/download/${encodeURIComponent(t)}`,"_blank")}}},A=x,j=(0,s.A)(A,T,$,!1,null,null,null),C=j.exports;o["default"].use(f.Ay);var U=new f.Ay({routes:[{path:"/login",component:F},{path:"/file",component:C}]}),E=n(9143),I=n.n(E);o["default"].use(I()),o["default"].use(U),o["default"].config.productionTip=!1,new o["default"]({render:t=>t(c),router:U,store:v}).$mount("#app")}},e={};function n(o){var r=e[o];if(void 0!==r)return r.exports;var a=e[o]={id:o,loaded:!1,exports:{}};return t[o].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}n.m=t,function(){n.amdO={}}(),function(){var t=[];n.O=function(e,o,r,a){if(!o){var l=1/0;for(c=0;c<t.length;c++){o=t[c][0],r=t[c][1],a=t[c][2];for(var i=!0,s=0;s<o.length;s++)(!1&a||l>=a)&&Object.keys(n.O).every((function(t){return n.O[t](o[s])}))?o.splice(s--,1):(i=!1,a<l&&(l=a));if(i){t.splice(c--,1);var u=r();void 0!==u&&(e=u)}}return e}a=a||0;for(var c=t.length;c>0&&t[c-1][2]>a;c--)t[c]=t[c-1];t[c]=[o,r,a]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){n.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){var t={524:0};n.O.j=function(e){return 0===t[e]};var e=function(e,o){var r,a,l=o[0],i=o[1],s=o[2],u=0;if(l.some((function(e){return 0!==t[e]}))){for(r in i)n.o(i,r)&&(n.m[r]=i[r]);if(s)var c=s(n)}for(e&&e(o);u<l.length;u++)a=l[u],n.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return n.O(c)},o=self["webpackChunkvuetest"]=self["webpackChunkvuetest"]||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))}();var o=n.O(void 0,[504],(function(){return n(9133)}));o=n.O(o)})();
//# sourceMappingURL=app.e823b97c.js.map